#allow coreference between "you" in a question and "I/we" in an answer
form=/pronoun/&text=/^(I|[Ww]e)/&mood!=/question/;mood=/question/&text=/^[Yy]our?s?/&anytext&anyagree;1;nopropagate
#propagate entity type across apposition
func=/appos/&anytext;has_child_func=/appos/&anytext&anyagree;0;propagate
#prefer pronouns to corefer to identical pronouns in same sentence
form=/pronoun/;text_lower=$1;0;nopropagate
#prefer inanimate pronouns to corefer with the subject up to one sentence back, if the last inanimate is a place or time
form=/pronoun/&agree=/inanim/&last[inanim]=/place|time|organization/;func=/nsubj/;1;nopropagate
#prefer inanimate pronouns to corefer not with an oblique pobj, if the last inanimate is an abstract (weaker version of the place/time constraint, allowing e.g. dobj and not forcing only subj)
form=/pronoun/&agree=/inanim/&last[inanim]=/abstract/;func!=/pobj|nn/;1;nopropagate
#identify coreferent light heads based on identical modifiers
lemma=/^one$/;mod=$1&anytext&form!=/proper/;4;nopropagate
#lemma=/^one$/;anytext&form=/common/;1;propagate_forward
anytext&form!=/proper/;lemma=/^one$/&mod=$1&anytext;4;nopropagate
text=/^[Mm]any$/;agree=/plural/&anytext;1;propagate
#allow coreference between nouns and their nsubj dependents (copula coreference; filter out for OntoNotes style no-copula-coreference)
pos=/NN?P?S?/&has_child_func=/cop/&has_child_func!=/neg/;func=/nsubj/&head=$1&anytext&anyagree;0;propagate
#pos=/NN?P?S?/&func=/xcomp/;func=/nsubj/&head=$1&anytext&anyagree;0;propagate
#allow coreference between quoted first person and unquoted third person
form=/pronoun/&text=/^I|[Mm]e|[Mm]y|[Mm]ine$/&quoted=True;func=/nsubj/&text=/[Ss]?[Hh]e/&anytext&anyagree&quoted=False;1;nopropagate
form=/pronoun/&text=/^I|[Mm]e|[Mm]y|[Mm]ine$/&quoted=True;func=/nsubj/&entity=/person/&anytext&anyagree&quoted=False;1;nopropagate
func=/nsubj/&entity=/person/&quoted=False;form=/pronoun/&text=/^I|[Mm]e|[Mm]y|[Mm]ine$/&quoted=True&anytext&anyagree;0;nopropagate
#allow coreference between quoted second person and unquoted first person
form=/pronoun/&text=/[Yy]our?s?/&quoted=True;func=/nsubj/&text=/^I|[Mm]e|[Mm]y|[Mm]ine$/&anytext&anyagree&quoted=False;1;nopropagate
#prefer pronouns to corefer to agreeing pronouns in same sentence
form=/pronoun/;form=/pronoun/&agree=$1;0;propagate_forward
#prefer pronouns to corefer to non-compound modifiers
form=/pronoun/;func!=/nn/;1;propagate_forward
#allow nouns to refer back to a compatible pronoun in previous sentence
#form!=/pronoun/&func!=/nn;form=/pronoun/&entity=$1&agree=$1&anytext;1;nopropagate
#allow long distance coreference for locations with identical heads
form=/proper/&entity=/location/;head=$1;100;nopropagate
#final default rule
none;none;15;nopropagate